<%- include('partials/layout_start', { title: 'Topics & Categories' }) %>

    <div class="content-container">
        <header class="page-header"
            style="margin-bottom: 2.5rem; display: flex; justify-content: space-between; align-items: flex-end;">
            <div>
                <nav class="breadcrumb">Home > Content Map</nav>
                <h1 style="border: none; margin-bottom: 0.5rem; font-size: 2.25rem;">Content Map</h1>
                <p style="color: var(--text-secondary);">Browse by structured topics or community labels.</p>
            </div>
            <button class="btn-primary" onclick="openTopicModal()">
                <i class="ph ph-plus-circle"></i> Create Topic
            </button>
        </header>

        <!-- Topics Section -->
        <section class="management-section" style="margin-bottom: 4rem;">
            <div class="section-header" style="margin-bottom: 1.5rem; display: flex; align-items: center; gap: 8px;">
                <i class="ph ph-bookmarks" style="font-size: 1.5rem; color: var(--primary-color);"></i>
                <h2 style="font-size: 1.25rem; font-weight: 700;">Managed Topics</h2>
            </div>

            <% if (topics && topics.length> 0) { %>
                <div class="topic-grid-managed"
                    style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1.5rem;">
                    <% topics.forEach(function(topic) { %>
                        <div class="topic-card-managed"
                            style="background: white; border: 1px solid var(--border-color); border-radius: var(--radius-md); padding: 1.5rem; transition: var(--transition); display: flex; flex-direction: column; gap: 1rem;">
                            <div style="display: flex; align-items: flex-start; justify-content: space-between;">
                                <div
                                    style="width: 48px; height: 48px; border-radius: 12px; background: <%= topic.color %>15; color: <%= topic.color %>; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">
                                    <i class="<%= topic.icon || 'ph ph-hash' %>"></i>
                                </div>
                                <a href="/categoria/<%= topic.name %>" class="btn-text-small"
                                    style="color: var(--primary-color);">View pages</a>
                            </div>
                            <div>
                                <h3 style="font-size: 1.125rem; font-weight: 700; margin-bottom: 0.5rem;">
                                    <%= topic.name %>
                                </h3>
                                <p
                                    style="font-size: 0.875rem; color: var(--text-secondary); line-height: 1.5; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                                    <%= topic.description || 'No description provided.' %>
                                </p>
                            </div>
                        </div>
                        <% }); %>
                </div>
                <% } else { %>
                    <div class="empty-state-simple"
                        style="padding: 2rem; background: #f8fafc; border: 1px dashed var(--border-color); border-radius: var(--radius-md); text-align: center;">
                        <p style="color: var(--text-secondary); font-size: 0.875rem;">No topics created yet. Topics help
                            organize your knowledge into large sections.</p>
                    </div>
                    <% } %>
        </section>

        <!-- Labels / Categories Section -->
        <section class="management-section">
            <div class="section-header" style="margin-bottom: 1.5rem; display: flex; align-items: center; gap: 8px;">
                <i class="ph ph-tag" style="font-size: 1.5rem; color: var(--magenta-color);"></i>
                <h2 style="font-size: 1.25rem; font-weight: 700;">Page Labels</h2>
            </div>

            <% if (allCategories && allCategories.length> 0) { %>
                <div class="label-cloud" style="display: flex; flex-wrap: wrap; gap: 0.75rem;">
                    <% allCategories.forEach(function(cat) { %>
                        <a href="/categoria/<%= cat.category %>" class="label-pill"
                            style="padding: 0.5rem 1rem; background: white; border: 1px solid var(--border-color); border-radius: 20px; text-decoration: none; color: var(--text-main); font-size: 0.875rem; font-weight: 600; transition: var(--transition); display: flex; align-items: center; gap: 6px;">
                            <span
                                style="width: 6px; height: 6px; border-radius: 50%; background: var(--magenta-color);"></span>
                            <%= cat.category %>
                        </a>
                        <% }); %>
                </div>
                <% } else { %>
                    <div class="empty-state-simple"
                        style="padding: 2rem; background: #f8fafc; border: 1px dashed var(--border-color); border-radius: var(--radius-md); text-align: center;">
                        <p style="color: var(--text-secondary); font-size: 0.875rem;">No labels have been used in pages
                            yet.</p>
                    </div>
                    <% } %>
        </section>
    </div>

    <style>
        .topic-card-managed:hover {
            border-color: var(--primary-color);
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .label-pill:hover {
            border-color: var(--magenta-color);
            background: #fdf2f8;
            transform: translateY(-1px);
        }
    </style>

    <%- include('partials/layout_end') %>